<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Run Any CLI Tool on a Conda Environment • condathis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Run Any CLI Tool on a Conda Environment">
<meta name="description" content="Simplifies the execution of command line interface (CLI) tools within isolated and reproducible environments. It enables users to effortlessly manage Conda environments, execute command line tools, handle dependencies, and ensure reproducibility in their data analysis workflows.">
<meta property="og:description" content="Simplifies the execution of command line interface (CLI) tools within isolated and reproducible environments. It enables users to effortlessly manage Conda environments, execute command line tools, handle dependencies, and ensure reproducibility in their data analysis workflows.">
<meta property="og:image" content="https://luciorq.github.io/condathis/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">condathis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/condathis.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/condathis-intro.html">condathis-intro</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luciorq/condathis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="condathis-">condathis 
<a class="anchor" aria-label="anchor" href="#condathis-"></a>
</h1>
</div>
<!-- badges: start -->

<blockquote>
<p>Run command-line tools in a <strong>reproducible</strong> and <strong>isolated</strong> way, right from R.</p>
</blockquote>
<p>Tired of <code><a href="https://rdrr.io/r/base/system.html" class="external-link">system()</a></code> calls that work on your machine but break everywhere else? <code>condathis</code> is here to help! It lets you create self-contained environments for your command-line tools, so your R code runs reliably for you, your colleagues, and your future self.</p>
<div class="section level2">
<h2 id="a-quick-example">A Quick Example<a class="anchor" aria-label="anchor" href="#a-quick-example"></a>
</h2>
<p>Let’s have some fun with <code>cowpy</code>. With just two commands, we can install and run it in its own isolated environment:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Install 'cowpy' into an environment named 'cowpy-env'</span></span>
<span><span class="fu">condathis</span><span class="fu">::</span><span class="fu"><a href="reference/create_env.html">create_env</a></span><span class="op">(</span>packages <span class="op">=</span> <span class="st">"cowpy"</span>, env_name <span class="op">=</span> <span class="st">"cowpy-env"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ! Environment cowpy-env succesfully created.</span></span>
<span></span>
<span><span class="co"># 2. Run it!</span></span>
<span><span class="co"># Example showing redirection from a file to the Standard Input (STDIN)</span></span>
<span><span class="va">temp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="st">"{condathis} is awesome!"</span>, <span class="va">temp_file</span><span class="op">)</span></span>
<span><span class="fu">condathis</span><span class="fu">::</span><span class="fu"><a href="reference/run.html">run</a></span><span class="op">(</span><span class="st">"cowpy"</span>, stdin <span class="op">=</span> <span class="va">temp_file</span>, env_name <span class="op">=</span> <span class="st">"cowpy-env"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  _________________________</span></span>
<span><span class="co">#&gt; &lt; {condathis} is awesome! &gt;</span></span>
<span><span class="co">#&gt;  -------------------------</span></span>
<span><span class="co">#&gt;      \   ^__^</span></span>
<span><span class="co">#&gt;       \  (oo)\_______</span></span>
<span><span class="co">#&gt;          (__)\       )\/\</span></span>
<span><span class="co">#&gt;            ||----w |</span></span>
<span><span class="co">#&gt;            ||     ||</span></span></code></pre></div>
<p>Maybe you want to try something fancier, like <code>rich-cli</code> for formatting messages?</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">condathis</span><span class="fu">::</span><span class="fu"><a href="reference/create_env.html">create_env</a></span><span class="op">(</span>packages <span class="op">=</span> <span class="st">"rich-cli"</span>, env_name <span class="op">=</span> <span class="st">"rich-cli-env"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ! Environment rich-cli-env succesfully created.</span></span>
<span></span>
<span><span class="fu">condathis</span><span class="fu">::</span><span class="fu"><a href="reference/run.html">run</a></span><span class="op">(</span></span>
<span>  <span class="st">"rich"</span>, <span class="st">"[b]Condathis[/b] is awesome!"</span>, <span class="st">"-p"</span>, <span class="st">"-a"</span>, <span class="st">"heavy"</span>,</span>
<span>  env_name <span class="op">=</span> <span class="st">"rich-cli-env"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ┏━━━━━━━━━━━━━━━━━━━━━━━┓</span></span>
<span><span class="co">#&gt; ┃ Condathis is awesome! ┃</span></span>
<span><span class="co">#&gt; ┗━━━━━━━━━━━━━━━━━━━━━━━┛</span></span></code></pre></div>
<p>That’s it! You can now package any command-line tool with your R script, ensuring it works everywhere, every time.</p>
</div>
<div class="section level2">
<h2 id="get-started">Get Started<a class="anchor" aria-label="anchor" href="#get-started"></a>
</h2>
<p>Install the release version of the package from <a href="https://cran.r-project.org/package=condathis" class="external-link">CRAN</a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"condathis"</span><span class="op">)</span></span></code></pre></div>
<p>Or get the development version from <a href="https://luciorq.r-universe.dev/condathis" class="external-link">R-Universe</a>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"condathis"</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://luciorq.r-universe.dev"</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="why-condathis">Why <code>condathis</code>?<a class="anchor" aria-label="anchor" href="#why-condathis"></a>
</h2>
<p>R’s <code><a href="https://rdrr.io/r/base/system.html" class="external-link">system()</a></code> and <code><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2()</a></code> are powerful, but they depend on tools being installed on the host system. This creates a few problems:</p>
<ul>
<li>
<strong>Reproducibility:</strong> Will your script from last year still work? Will your collaborator be able to run your code if they have a different version of a tool?</li>
<li>
<strong>Conflicts:</strong> What if two different tools need two different versions of the same dependency?</li>
</ul>
<p><a href="https://github.com/luciorq/condathis" class="external-link">condathis</a> solves these issues by creating isolated environments for each tool.</p>
<div class="section level3">
<h3 id="reproducibility-an-example">Reproducibility: An Example<a class="anchor" aria-label="anchor" href="#reproducibility-an-example"></a>
</h3>
<p>Let’s say you’re using <code>fastqc</code> for quality control in a bioinformatics pipeline. Different versions of <code>fastqc</code> can produce slightly different results.</p>
<p>With <a href="https://github.com/luciorq/condathis" class="external-link">condathis</a>, you can lock in a specific version:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fastq_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sample1_L001_R1_001.fastq.gz"</span>, package <span class="op">=</span> <span class="st">"condathis"</span><span class="op">)</span></span>
<span><span class="va">temp_out_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"output"</span><span class="op">)</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html" class="external-link">dir_create</a></span><span class="op">(</span><span class="va">temp_out_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Always use fastqc version 0.12.1</span></span>
<span><span class="fu">condathis</span><span class="fu">::</span><span class="fu"><a href="reference/create_env.html">create_env</a></span><span class="op">(</span>packages <span class="op">=</span> <span class="st">"fastqc==0.12.1"</span>, channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"conda-forge"</span>, <span class="st">"bioconda"</span><span class="op">)</span>, env_name <span class="op">=</span> <span class="st">"fastqc-0.12.1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ! Environment fastqc-0.12.1 succesfully created.</span></span>
<span><span class="fu">condathis</span><span class="fu">::</span><span class="fu"><a href="reference/run.html">run</a></span><span class="op">(</span><span class="st">"fastqc"</span>, <span class="va">fastq_file</span>, <span class="st">"-o"</span>, <span class="va">temp_out_dir</span>, env_name <span class="op">=</span> <span class="st">"fastqc-0.12.1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; application/gzip</span></span>
<span><span class="co">#&gt; Started analysis of sample1_L001_R1_001.fastq.gz</span></span>
<span><span class="co">#&gt; Approx 90% complete for sample1_L001_R1_001.fastq.gz</span></span>
<span><span class="co">#&gt; Analysis complete for sample1_L001_R1_001.fastq.gz</span></span></code></pre></div>
<p>Now your analysis will produce the same output files, regardless of where or when it’s run.</p>
</div>
<div class="section level3">
<h3 id="isolation-an-example">Isolation: An Example<a class="anchor" aria-label="anchor" href="#isolation-an-example"></a>
</h3>
<p>Need to use a specific version of a tool like <code>curl</code> that’s different from your system’s version? No problem.</p>
<p>Your system’s <code>curl</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/libcurlVersion.html" class="external-link">libcurlVersion</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "8.7.1"</span></span>
<span><span class="co">#&gt; attr(,"ssl_version")</span></span>
<span><span class="co">#&gt; [1] "SecureTransport (LibreSSL/3.3.6)"</span></span>
<span><span class="co">#&gt; attr(,"libssh_version")</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; attr(,"protocols")</span></span>
<span><span class="co">#&gt;  [1] "dict"    "file"    "ftp"     "ftps"    "gopher"  "gophers" "http"</span></span>
<span><span class="co">#&gt;  [8] "https"   "imap"    "imaps"   "ldap"    "ldaps"   "mqtt"    "pop3"</span></span>
<span><span class="co">#&gt; [15] "pop3s"   "rtsp"    "smb"     "smbs"    "smtp"    "smtps"   "telnet"</span></span>
<span><span class="co">#&gt; [22] "tftp"</span></span></code></pre></div>
<p>A specific <code>curl</code> version, isolated with <code>condathis</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">condathis</span><span class="fu">::</span><span class="fu"><a href="reference/create_env.html">create_env</a></span><span class="op">(</span></span>
<span>  packages <span class="op">=</span> <span class="st">"curl==8.10.1"</span>,</span>
<span>  env_name <span class="op">=</span> <span class="st">"curl-env"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ! Environment curl-env succesfully created.</span></span>
<span></span>
<span><span class="co"># Handling output thorough R objects</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">condathis</span><span class="fu">::</span><span class="fu"><a href="reference/run.html">run</a></span><span class="op">(</span></span>
<span>  <span class="st">"curl"</span>, <span class="st">"--version"</span>,</span>
<span>  env_name <span class="op">=</span> <span class="st">"curl-env"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="st">"silent"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">stdout</span><span class="op">)</span></span>
<span><span class="co">#&gt; curl 8.10.1 (aarch64-apple-darwin20.0.0) libcurl/8.10.1 OpenSSL/3.5.4 (SecureTransport) zlib/1.3.1 zstd/1.5.7 libssh2/1.11.1 nghttp2/1.67.0</span></span>
<span><span class="co">#&gt; Release-Date: 2024-09-18</span></span>
<span><span class="co">#&gt; Protocols: dict file ftp ftps gopher gophers http https imap imaps ipfs ipns mqtt pop3 pop3s rtsp scp sftp smb smbs smtp smtps telnet tftp ws wss</span></span>
<span><span class="co">#&gt; Features: alt-svc AsynchDNS GSS-API HSTS HTTP2 HTTPS-proxy IPv6 Kerberos Largefile libz MultiSSL NTLM SPNEGO SSL threadsafe TLS-SRP UnixSockets zstd</span></span></code></pre></div>
<p>This allows you to run tools with conflicting dependencies side-by-side without any issues.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-it-works">How It Works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h2>
<p>The package <a href="https://github.com/luciorq/condathis" class="external-link">condathis</a> relies on <a href="https://mamba.readthedocs.io/en/latest/user_guide/micromamba.html" class="external-link"><strong><code>micromamba</code></strong></a> to bring <strong>reproducibility and isolation</strong>. <code>micromamba</code> is a lightweight, fast, and efficient package manager that “does not need a base environment and does not come with a default version of Python”.</p>
<p>The integration of <code>micromamba</code> into <code>R</code> is handled using the <code>processx</code> and <code>withr</code> packages.</p>
</div>
<div class="section level2">
<h2 id="known-caveats">Known Caveats<a class="anchor" aria-label="anchor" href="#known-caveats"></a>
</h2>
<p>Special characters in CLI commands are interpreted as literals and not expanded.</p>
<ul>
<li>It is not supported the use of output redirections in commands, e.g. “|” or “&gt;”.
<ul>
<li>Instead of redirects (e.g. “&gt;”), use the argument <code>stdout = "&lt;FILENAME&gt;.txt"</code>. Instead of Pipes (“|”), simple run multiple calls to <code><a href="reference/run.html">condathis::run()</a></code>, using <code>stdout</code> argument to control the output and <code>stdin</code> to control the input of each command. P.S. The current implementation only supports files as the “STDIN”.</li>
</ul>
</li>
<li>File paths should not use special characters for relative paths, e.g. “~”, “.”, “..”.
<ul>
<li>Expand file paths directly in R, using <code>base</code> functions or functions from the <code>fs</code> package.</li>
</ul>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=condathis" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/luciorq/condathis/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/luciorq/condathis/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing condathis</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Lucio Queiroz <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-6090-1834" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Claudio Zanettini <br><small class="roles"> Author, contributor </small> <a href="https://orcid.org/0000-0001-5043-8033" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/luciorq/condathis/actions/workflows/r-cmd-check.yaml" class="external-link"><img src="https://github.com/luciorq/condathis/actions/workflows/r-cmd-check.yaml/badge.svg" alt="r-cmd-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=condathis" class="external-link"><img src="https://www.r-pkg.org/badges/version/condathis" alt="CRAN status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucio Queiroz, Claudio Zanettini.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
