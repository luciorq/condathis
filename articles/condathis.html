<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to condathis • condathis</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="condathis_files/libs/quarto-html/popper.min.js"></script><script src="condathis_files/libs/quarto-html/tippy.umd.min.js"></script><link href="condathis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="condathis_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to condathis">
<meta property="og:image" content="https://luciorq.github.io/condathis/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">condathis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/condathis.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/condathis-intro.html">condathis-intro</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luciorq/condathis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to condathis</h1>




      <small class="dont-index">Source: <a href="https://github.com/luciorq/condathis/blob/v0.1.3/vignettes/condathis.qmd" class="external-link"><code>vignettes/condathis.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction-to-condathis">Introduction to <code>condathis</code>
<a class="anchor" aria-label="anchor" href="#introduction-to-condathis"></a>
</h2>
<p>Running command-line (CLI) tools from R can be a powerful way to extend your analysis, but it often comes with challenges. How do you ensure that the tool is installed? How do you manage its dependencies without conflicting with other software on your system? How do you make your analysis reproducible for others?</p>
<p>The <code>condathis</code> package is designed to solve these problems. It allows you to run any CLI tool in a sandboxed, reproducible environment, powered by <code>micromamba</code>.</p>
<p>This vignette provides a brief introduction to the core functionality of <code>condathis</code>.</p>
<section class="level2"><h3 id="the-problem-reproducible-cli-execution">The Problem: Reproducible CLI Execution<a class="anchor" aria-label="anchor" href="#the-problem-reproducible-cli-execution"></a>
</h3>
<p>Imagine you want to analyze a BAM file using <code>samtools</code>, a popular bioinformatics tool. You could write an R script that calls <code>samtools</code> using <code><a href="https://rdrr.io/r/base/system.html" class="external-link">system()</a></code>, but this approach has some drawbacks:</p>
<ol type="1">
<li>
<strong>Dependency Hell:</strong> Your script depends on <code>samtools</code> being installed and available in the system’s <code>PATH</code>. If you share your script with a colleague, they will need to install it manually, and they might install a different version, which could lead to different results.</li>
<li>
<strong>Conflicts:</strong> Installing <code>samtools</code> and its dependencies might conflict with other tools already installed on the system.</li>
<li>
<strong>Reproducibility:</strong> It’s hard to guarantee that your analysis will run the same way on different machines or at a later time, as the software environment is not explicitly defined.</li>
</ol></section><section class="level2"><h3 id="the-condathis-solution">The <code>condathis</code> Solution<a class="anchor" aria-label="anchor" href="#the-condathis-solution"></a>
</h3>
<p><code>condathis</code> solves this by creating isolated environments for your tools. Let’s see how to use it to run <code>samtools</code>.</p>
<section class="level3"><h4 id="step-1-create-an-environment">Step 1: Create an Environment<a class="anchor" aria-label="anchor" href="#step-1-create-an-environment"></a>
</h4>
<p>First, we’ll create a Conda environment that contains <code>samtools</code>. We can do this with <code><a href="../reference/create_env.html">create_env()</a></code>. We’ll specify the packages we need (in this case, <code>samtools</code> from the <code>bioconda</code> channel).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_env.html">create_env</a></span><span class="op">(</span></span>
<span>  packages <span class="op">=</span> <span class="st">"samtools"</span>,</span>
<span>  channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bioconda"</span>, <span class="st">"conda-forge"</span><span class="op">)</span>,</span>
<span>  env_name <span class="op">=</span> <span class="st">"samtools-env"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<p>This command will:</p>
<ol type="1">
<li>Install <code>micromamba</code> if it’s not already available (don’t worry, it’s a single, self-contained executable and won’t interfere with your system).</li>
<li>Create a new Conda environment named <code>samtools-env</code>.</li>
<li>Install <code>samtools</code> into that environment.</li>
</ol></section><section class="level3"><h4 id="step-2-run-the-tool">Step 2: Run the Tool<a class="anchor" aria-label="anchor" href="#step-2-run-the-tool"></a>
</h4>
<p>Now that we have our environment, we can use <code><a href="../reference/run.html">run()</a></code> to execute <code>samtools</code> commands. <code>condathis</code> includes an example BAM file that we can use for this demonstration.</p>
<p>Let’s use <code>samtools view</code> to inspect the header of our example BAM file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the path to the example BAM file</span></span>
<span><span class="va">bam_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example.bam"</span>, package <span class="op">=</span> <span class="st">"condathis"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run samtools view -H on the BAM file</span></span>
<span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="st">"samtools"</span>, <span class="st">"view"</span>, <span class="st">"-H"</span>, <span class="va">bam_file</span>, env_name <span class="op">=</span> <span class="st">"samtools-env"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The <code><a href="../reference/run.html">run()</a></code> function takes care of finding the correct environment and executing the command inside it. The output of the command is printed to the R console.</p>
</section><section class="level3"><h4 id="putting-it-all-together">Putting It All Together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h4>
<p>Here is a complete, reproducible example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/luciorq/condathis" class="external-link">condathis</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an environment with samtools</span></span>
<span><span class="fu"><a href="../reference/create_env.html">create_env</a></span><span class="op">(</span></span>
<span>  packages <span class="op">=</span> <span class="st">"samtools"</span>,</span>
<span>  channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bioconda"</span>, <span class="st">"conda-forge"</span><span class="op">)</span>,</span>
<span>  env_name <span class="op">=</span> <span class="st">"samtools-env"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the path to the example BAM file</span></span>
<span><span class="va">bam_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example.bam"</span>, package <span class="op">=</span> <span class="st">"condathis"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run samtools to view the header</span></span>
<span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span></span>
<span>  <span class="st">"samtools"</span>, <span class="st">"view"</span>, <span class="st">"-H"</span>, <span class="va">bam_file</span>,</span>
<span>  env_name <span class="op">=</span> <span class="st">"samtools-env"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean up the environment</span></span>
<span><span class="fu"><a href="../reference/remove_env.html">remove_env</a></span><span class="op">(</span><span class="st">"samtools-env"</span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h3 id="why-condathis">Why <code>condathis</code>?<a class="anchor" aria-label="anchor" href="#why-condathis"></a>
</h3>
<p>By using <code>condathis</code>, you get:</p>
<ul>
<li>
<strong>Isolation:</strong> Dependencies for each tool are kept separate, avoiding conflicts.</li>
<li>
<strong>Reproducibility:</strong> Your R script now defines and creates the exact software environment it needs. Anyone can run your script and get the same results.</li>
<li>
<strong>Simplicity:</strong> You can manage everything from within R, without needing to manually use the command line to manage Conda environments.</li>
</ul>
<p><code>condathis</code> is a powerful tool for making your R analyses that rely on external command-line tools more robust and reproducible.</p>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucio Queiroz, Claudio Zanettini.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
